{"version":3,"sources":["../../src/test_util.js"],"names":["TestUtils","span","expectedTags","actualTags","i","_tags","length","key","value","tag","hasOwnProperty","console","log","keys","filteredTags"],"mappings":";;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AACA;;;;AACA;;;;;;;;IAEqBA,S;;;;;;;gCACFC,I,EAAYC,Y,EAA4B;AACnD;AACA,gBAAIC,aAAa,EAAjB;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,KAAKI,KAAL,CAAWC,MAA/B,EAAuCF,GAAvC,EAA4C;AACxC,oBAAIG,MAAMN,KAAKI,KAAL,CAAWD,CAAX,EAAcG,GAAxB;AACAJ,2BAAWI,GAAX,IAAkBN,KAAKI,KAAL,CAAWD,CAAX,EAAcI,KAAhC;AACH;;AAED,iBAAK,IAAIC,GAAT,IAAgBP,YAAhB,EAA8B;AAC1B,oBAAIA,aAAaQ,cAAb,CAA4BD,GAA5B,KAAoCN,WAAWO,cAAX,CAA0BD,GAA1B,CAAxC,EAAwE;AACpE,wBAAIN,WAAWM,GAAX,MAAoBP,aAAaO,GAAb,CAAxB,EAA2C;AACvCE,gCAAQC,GAAR,CAAY,eAAZ,EAA6BV,aAAaO,GAAb,CAA7B,EAAgD,gBAAhD,EAAkEN,WAAWM,GAAX,CAAlE;AACA,+BAAO,KAAP;AACH;AACJ,iBALD,MAKO;AACH;AACA,2BAAO,KAAP;AACH;AACJ;;AAED,mBAAO,IAAP;AACH;;AAED;;;;;;;;;gCAMeR,I,EAAYY,I,EAA2B;AAClD,gBAAIV,aAAa,EAAjB;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,KAAKI,KAAL,CAAWC,MAA/B,EAAuCF,GAAvC,EAA4C;AACxC,oBAAIG,MAAMN,KAAKI,KAAL,CAAWD,CAAX,EAAcG,GAAxB;AACAJ,2BAAWI,GAAX,IAAkBN,KAAKI,KAAL,CAAWD,CAAX,EAAcI,KAAhC;AACH;AACD,gBAAIK,IAAJ,EAAU;AACN,oBAAIC,eAAe,EAAnB;AACA,qBAAK,IAAIV,KAAI,CAAb,EAAgBA,KAAIS,KAAKP,MAAzB,EAAiCF,IAAjC,EAAsC;AAClC,wBAAIG,OAAMM,KAAKT,EAAL,CAAV;AACA,wBAAID,WAAWO,cAAX,CAA0BH,IAA1B,CAAJ,EAAoC;AAChCO,qCAAaP,IAAb,IAAoBJ,WAAWI,IAAX,CAApB;AACH;AACJ;AACD,uBAAOO,YAAP;AACH;AACD,mBAAOX,UAAP;AACH;;;;;;kBA/CgBH,S","file":"test_util.js","sourcesContent":["// @flow\n// Copyright (c) 2016 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport opentracing from 'opentracing';\nimport Span from './span';\nimport Utils from './util';\n\nexport default class TestUtils {\n    static hasTags(span: Span, expectedTags: any): boolean {\n        // TODO(oibe) make this work for duplicate tags\n        let actualTags = {};\n        for (let i = 0; i < span._tags.length; i++) {\n            let key = span._tags[i].key;\n            actualTags[key] = span._tags[i].value;\n        }\n\n        for (let tag in expectedTags) {\n            if (expectedTags.hasOwnProperty(tag) && actualTags.hasOwnProperty(tag)) {\n                if (actualTags[tag] !== expectedTags[tag]) {\n                    console.log('expected tag:', expectedTags[tag], ', actual tag: ', actualTags[tag]);\n                    return false;\n                }\n            } else {\n                // mismatch in tag keys\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    /**\n     * Returns tags stored in the span. If tags with the same key are present,\n     * only the last tag is returned.\n     * @param {Object} span - span from which to read the tags.\n     * @param {Array} [keys] - if specified, only tags with these keys are returned.\n     */\n    static getTags(span: Span, keys: ?Array<string>): any {\n        let actualTags = {};\n        for (let i = 0; i < span._tags.length; i++) {\n            let key = span._tags[i].key;\n            actualTags[key] = span._tags[i].value;\n        }\n        if (keys) {\n            let filteredTags = {};\n            for (let i = 0; i < keys.length; i++) {\n                let key = keys[i];\n                if (actualTags.hasOwnProperty(key)) {\n                    filteredTags[key] = actualTags[key];\n                }\n            }\n            return filteredTags;\n        }\n        return actualTags;\n    }\n}\n"]}